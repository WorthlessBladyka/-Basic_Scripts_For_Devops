# Как это всё работает вместе? Простой сценарий.

**Задача:** Развернуть на чистом сервере наше приложение (веб-сайт).

1. **Bash-скрипт (подготовка):** Может подготовить сервер — установить сам Docker и другие базовые пакеты.
``` setup-server.sh
apt update
apt install -y docker.io
usermod -aG docker $USER
```

2. **Docker (упаковка приложения):** Наше приложение уже упаковано в Docker-образ `my-app:latest` и лежит в реестре.

3. **Ansible (развертывание и настройка):** Пишем playbook, который:
	- Подключится к серверу	
	- Запустит скрипт подготовки (из п.1)
	- Скачает наш Docker-образ `my-app:latest`
	- Запустит контейнер с нужными параметрами (порты, переменные окружения)
	- Настроит Nginx (также в контейнере) как обратный прокси для нашего приложения
# 
- ==**Playbook**== - это отдельный YAML файл, который содержит список plays. Здесь play обозначает набор активностей, которые будут выполнены на одном или группе хостов.
![[Снимок экрана 2025-11-10 в 12.34.34 AM.png]]
- Отдельное, атомарное действие, которое будет произведено с хостом называется ==**task**==.
	- Вот некоторые примеры tasks: 
		- выполнить команду или скрипт на хосте 
		- установить пакет на хосте 
		- выполнить перезагрузку или выключение машины
# Format
![[Снимок экрана 2025-11-10 в 12.37.48 AM.png]]
1) Любой playbook - это list of dictionaries в терминах YAML
	- Каждый из play - это dictionary с определенным набором свойств, которые называются hosts, name и tasks. Порядок в dictionary не учитывается
2) Все иначе с tasks. Потому что tasks, являются list или массивом. List - это упорядоченная коллекция, в ней важна позиция элемента
	- И если здесь записи поменять местами, мы проинструктируем Ansible сначала запустить службу web-server, до ее инсталляции в систему, что невозможно и система вернет нам ошибку

![[Снимок экрана 2025-11-10 в 12.49.07 AM.png]]
1) Параметр hosts указывает на каких хостах выполнять данные операции.
	- Сюда можно вставить любой хост или группу, но ты должен быть уверен, что они присутствуют в inventory, с которым будет запущен playbook.
